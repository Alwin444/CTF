To crack .cap file: aircrack-ng file_name.cap -w wordlist_name
	NB: wordlists location - /usr/share/wordlists (For this purpose , use wifite wordlists)





 PCAP Analysis (Offline WiFi CTF).

This is very common in CTFs because it tests analysis skills, not just tool usage.

ğŸ“¦PCAP Analysis (Offline WiFi CTF)

In this type of challenge, you are given a file like:

capture.pcap
wifi_dump.cap
challenge.pcapng


You are not capturing live traffic. Everything is already recorded.

Your job:

Extract useful WiFi artifacts

Recover credentials or keys

Find the flag inside packets

ğŸ” Step 1: Open in Wireshark
wireshark capture.pcap

ğŸ¯ Scenario A: WPA/WPA2 Handshake Extraction
What to Look For

Filter:

eapol


If you see 4 packets between AP and client â†’ you captured the 4-way handshake.

4
Confirm Handshake

Go to:

Edit â†’ Preferences â†’ Protocols â†’ IEEE 802.11


Enable:
âœ” â€œEnable decryptionâ€
âœ” â€œAssume packets have FCSâ€

Wireshark will sometimes show:

WPA Key: handshake

ğŸ”“ Step 2: Convert PCAP to Crackable Hash

Use:

aircrack-ng capture.pcap -J output


This generates:

output.hccapx


Then crack using:

hashcat

hashcat -m 2500 output.hccapx rockyou.txt


If cracked â†’ password = flag.

ğŸ¯ Scenario B: PMKID Attack (More Advanced)

Sometimes no full handshake is present.

Filter:

eapol


But only one packet exists.

That may be PMKID-based attack.

Extract using:

hcxdumptool
hcxpcapngtool capture.pcap -o hash.hc22000


Then:

hashcat -m 22000 hash.hc22000 rockyou.txt

ğŸ¯ Scenario C: Hidden Flag Inside Packets

Sometimes the flag is NOT a password.

Look for:

1ï¸âƒ£ Beacon Frames

Filter:

wlan.fc.type_subtype == 0x08


Sometimes flag hidden in:

SSID

Vendor specific tag

Unusual hex data

2ï¸âƒ£ HTTP Traffic After Decryption

If WiFi is open:

Filter:

http


Then:
Right click â†’ Follow â†’ TCP Stream

Flag may appear in:

Login POST request

Downloaded file

Cookies

3ï¸âƒ£ Base64 Encoded Flag in Payload

Check:

Data â†’ Hex view


Copy suspicious strings and decode:

echo "string" | base64 -d

ğŸ¯ Scenario D: Extract Objects

If traffic contains file transfer:

In Wireshark:

File â†’ Export Objects


Export:

HTTP

SMB

FTP

Sometimes the flag is inside an image or PDF.